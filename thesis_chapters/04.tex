\chapter{Particle Spectra from Classical Source}

\section{Canonical Quantization}

In the following we review the textbook procedure of canonical quantization of a field theory, see for example \cite{PeskinSchroeder_1995}. In this context, it is the step needed to define a notion of particle number and particle spectra.

\subsection{Real Scalar Field}

Consider a real scalar field $\varphi$ with Lagrangian density ($\eta=\text{diag}(-,+,+,+)$)
\begin{equation}
    \mathcal{L}=-\frac{1}{2}(\partial_\mu\varphi)(\partial^\mu\varphi)-V(\varphi)=\frac{1}{2}(\dot{\varphi}^2-\vec{\nabla}^2\varphi)-V(\varphi)
    \label{eq:LagrangianRealScalar}
\end{equation}
with associated Hamiltonian density
\begin{equation}
    \mathcal{H}=\pi\dot{\varphi}-\mathcal{L}=\frac{1}{2}(\pi^2+(\vec{\nabla}\varphi)^2)+V(\varphi)
\end{equation}
where $\pi=\frac{\partial\mathcal{L}}{\partial\dot{\varphi}}=\dot{\varphi}$ is the canonical conjugate momentum. Choose the free scalar field, $V(\varphi)=\frac{1}{2}m^2\varphi^2$. The equations of motion arising from this is the Klein-Gordon equation
\begin{equation}
    (\partial_\mu\partial^\mu-m^2)\varphi(t,\vec{x})=0\,.
    \label{eq:KGEq}
\end{equation}
This is a wave equation. Its most general solution solution is a superposition of plane waves, i.e. sine and cosine functions or equivalently complex exponentials,
\begin{subequations}
    \begin{align}
        \varphi(t,x)               & =\int\frac{\dt ^3p}{(2\pi)^3}\mathcal{N}_{\vec{p}}\left\{a_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+b_{\vec{p}}^* e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\right\}                                                 \\
        \pi(t,x) & =\int\frac{\dt ^3p}{(2\pi)^3}\mathcal{N}_{\vec{p}}\left\{-\imagu\omega_{\vec{p}}a_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+\imagu\omega_{\vec{p}}b_{\vec{p}}^* e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\right\}\,.
    \end{align}
\end{subequations}
only subject to the condition $\omega_{\vec{p}}=\sqrt{m^2+\vec{p}^2}$. $a_{\vec{p}}$ and $b_{\vec{p}}^*$ are complex Fourier coefficients. Reality of $\varphi$ further implies $a_{\vec{p}}=b_{\vec{p}}$. The normalization is typically chosen as $\mathcal{N}_{\vec{p}}^2\omega_{\vec{p}}=\frac{1}{2}$ for reasons that will become clear in a moment. If one uses
\begin{defin}[Poisson Brackets on Field Space]{def:PoissonBrack}
    \begin{equation}
        \poisson{A,B}=\int\dt^3x\left[\frac{\delta A}{\delta\varphi}\frac{\delta B}{\delta\pi}-\frac{\delta A}{\delta\pi}\frac{\delta B}{\delta\varphi}\right]
    \end{equation}
\end{defin}
the field and momentum fields satisfy
\begin{equation}
    \poisson{\varphi(t,x),\varphi(t,y)}=\poisson{\pi(t,x),\pi(t,y)}=0\,,\quad\poisson{\varphi(t,x),\pi(t,y)}=\delta^{(d)}(x-y)\,.
\end{equation}

Canonical quantization is now achieved by lifting fields to operators, $\varphi\to\hat{\varphi}$ and $\pi\to\hat{\pi}$, and therefore also $a_{\vec{p}}\to\hat{a}_{\vec{p}}$ and $a_{\vec{p}}^*\to\hat{a}_{\vec{p}}^\dagger$, though the $\hat{\cdot}$ will be conventionally omitted. The Poisson brackets are replaced by commutation relations,
\begin{equation}
    \imagu\{\cdot,\cdot\}\to\commut{\cdot,\cdot}\,.
\end{equation}
Following the short calculation in Appendix \ref{sec:Apdx_LadderCommut}, the fundamental commutator ${\commut{\varphi(t,x),\pi(t,y)}=\imagu\delta^{(d)}(x-y)}$ then implies
\begin{impt}[Commutators of $a_{\vec{p}}$, $a_{\vec{q}}^\dagger$]{impt:LadderCommut}
    \begin{equation}
        \commut{a_{\vec{p}},a_{\vec{q}}}=\commut{a_{\vec{p}}^\dagger,a_{\vec{q}}^\dagger}=0\,,\quad\commut{a_{\vec{p}},a_{\vec{q}}^\dagger}=(2\pi)^3\delta^{(3)}(\vec{p}-\vec{q})\,,
        \label{eq:LadderOpsCommut}
    \end{equation}
\end{impt}
where the normalization mentioned above was used to make the commutator independent of momentum $\vec{p}$. After this quantization, the fields are written as
\begin{subequations}
    \begin{align}
        \varphi(t,x)               & =\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}\left\{a_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+a_{\vec{p}}^\dagger e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\right\}                                                 \label{eq:CanonicalQuant_RealScalar}\\
       \pi(t,x) & =\int\frac{\dt ^3p}{(2\pi)^3}\frac{\imagu\omega_{\vec{p}}}{\sqrt{2\omega_{\vec{p}}}}\left\{-a_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+a_{\vec{p}}^\dagger e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\right\}\,.
    \end{align}
\end{subequations}
To express the Hamiltonian in terms of $a_{\vec{p}}$ and $a_{\vec{p}}^\dagger$ it is useful rewrite
\begin{subequations}
    \begin{align}
        \varphi(t,x)               & =\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}\left\{a_{\vec{p}}e^{-\imagu\omega_{\vec{p}}t}+a_{-\vec{p}}^\dagger e^{\imagu\omega_{\vec{p}}t}\right\}e^{\imagu\vec{p}\vec{x}}                                             \\
        \pi(t,x) & =\int\frac{\dt ^3p}{(2\pi)^3}\frac{\imagu\omega_{\vec{p}}}{\sqrt{2\omega_{\vec{p}}}}\left\{-a_{\vec{p}}e^{-\imagu\omega_{\vec{p}}t}+a_{-\vec{p}}^\dagger e^{\imagu\omega_{\vec{p}}t}\right\}e^{\imagu\vec{p}\vec{x}}\,.
    \end{align}
\end{subequations}
The Hamiltonian is now easily computed to be (see Appendix \ref{sec:Apdx_HamiltLadder})
\begin{equation}
        H=\int\frac{\dt^3p}{(2\pi)^3}\omega_{\vec{p}}(a_{\vec{p}}^\dagger a_{\vec{p}}+\frac{1}{2}[a_{\vec{p}},a_{\vec{p}}^\dagger])\,.
        \label{eq:HamiltonianWithLadderOps}
\end{equation}
The commutation relation between $H$, $a_{\vec{p}}$ and $a_{\vec{p}}^\dagger$ are given by
\begin{equation}
    [H,a_{\vec{p}}]=-\omega_{\vec{p}}a_{\vec{p}}\,,\qquad[H,a_{\vec{p}}^\dagger]=\omega_{\vec{p}}a_{\vec{p}}^\dagger\,.
    \label{eq:HamiltLadderCommut}
\end{equation}
This allows for an algebraic treatment of the eigenvalue problem of this Hamiltonian. From the well-known quantum mechanical harmonic oscillators, it is clear that $H$ has a discrete spectrum of excitations or energy eigenstates for each of its (continuous) momentum modes $\vec{p}$, such that
\begin{equation}
    H\ket{n_{\vec{p}}}=(\omega_{\vec{p}}+E_0)\ket{n_{\vec{p}}}\,.
\end{equation}
By applying equations \eqref{eq:HamiltLadderCommut} to an eigenstate $\ket{n_{\vec{p}}}$ one finds that the operator $a_{\vec{p}}$ ($a_{\vec{p}}^\dagger$) annihilates (creates) excitations in the momentum mode $\vec{p}$,
\begin{equation}
    a_{\vec{p}}\ket{n_{\vec{p}}}=\sqrt{n_{\vec{p}}} \ket{(n-1)_{\vec{p}}}\,,\qquad a_{\vec{p}}^\dagger\ket{n_{\vec{p}}}= \sqrt{(n+1)_{\vec{p}}}\ket{(n+1)_{\vec{p}}}\,.
\end{equation}
$E_0$ is a divergent vacuum energy, induced by the commutator ${[a_{\vec{p}},a_{\vec{p}}^\dagger]\propto\delta^{(3)}(0)}$. The ground state is defined by $a_{\vec{p}}\ket{0}=0$ $\forall\vec{p}$. The operator
\begin{equation}
    N_{\vec{p}}=a_{\vec{p}}^\dagger a_{\vec{p}}
\end{equation}
is the number operator for a given momentum mode and its expectation value $n(\vec{p})=\langle N_{\vec{p}}\rangle$ has the interpretation of the momentum space number density,
\begin{equation}
    N=\int\frac{\dt^3p}{(2\pi)^3}n(\vec{p})\,,\qquad n(\vec{p})=(2\pi)^3\frac{\dt N}{\dt^3p}\,.
    \label{eq:NumberDensity}
\end{equation}
With this, the interpretation of the Hamiltonian \eqref{eq:HamiltonianWithLadderOps} is straightforward: Up to a divergent constant, it is simply the sum (integral) of ${n(\vec{p})}$ excitations with energy ${\omega(\vec{p})}$ over all momentum modes $\vec{p}$.

\subsection{Complex Scalar Field}

Consider a complex scalar field ${\phi=\frac{1}{\sqrt{2}}(\varphi_1+\imagu\varphi_2)}$ with ${\varphi_k,k\in\{1,2\}}$ two real scalar fields. The Lagrangian of $\phi$ can be written as the sum of the Lagrangians $\mathcal{L}_k$ of $\varphi_k$,
\begin{equation}
    \mathcal{L}=-(\partial_\mu\phi^*)(\partial^\mu\phi)-m^2\phi\phi^*=\sum_{k}\Big\{-\frac{1}{2}\Big((\partial_\mu\varphi_k)(\partial^\mu\varphi_k)+m^2\varphi_k^2\Big)\Big\}=\sum_k\mathcal{L}_k\,.
\end{equation}
With the conjugate momenta $\pi_k=\dot{\varphi}_k$ the conjugate momentum of $\phi$ turns out to be
\begin{equation}
    \pi=\frac{\partial\mathcal{L}}{\partial\dot{\phi}}=\dot{\phi}^*=\frac{\pi_1-\imagu\pi_2}{\sqrt{2}}
\end{equation}
and the Hamiltonian is therefore
\begin{multline}
    \mathcal{H}=\pi\dot{\phi}+\pi^*\dot{\phi}^*-\mathcal{L}=\dot{\phi}\dot{\phi}^*+(\vec{\nabla}\phi)(\vec{\nabla}\phi^*)+m^2\phi\phi^*\\
    =\sum_k\frac{1}{2}(\pi_k^2+(\vec{\nabla}\varphi_k)^2+m^2\varphi_k^2)=\sum_k\mathcal{H}_k\,.
\end{multline}

Quantization rules are imposed as before on the real scalar fields $\varphi_k$. From this, it is immediately clear that $\phi(t,\vec{x})$ takes the form
\begin{subequations}    
    \begin{align}
        \phi(t,\vec{x})&=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}\Big\{\frac{a_{\vec{p},(1)}+\imagu a_{\vec{p},(2)}}{\sqrt{2}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+\frac{a_{\vec{p},(1)}^\dagger+\imagu a_{\vec{p},(2)}^\dagger}{\sqrt{2}}e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\Big\}\,,\\
        \pi(t,\vec{x})&=\int\frac{\dt^3p}{(2\pi)^3}\frac{\imagu\omega_{\vec{p}}}{\sqrt{2\omega_{\vec{p}}}}\Big\{-\frac{a_{\vec{p},(1)}-\imagu a_{\vec{p},(2)}}{\sqrt{2}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+\frac{a_{\vec{p},(1)}^\dagger-\imagu a_{\vec{p},(2)}^\dagger}{\sqrt{2}}e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\Big\}\,.
    \end{align}
\end{subequations}
It is intuitive to define
\begin{equation}
    a_{\vec{p}}=\frac{a_{\vec{p},(1)}+\imagu a_{\vec{p},(2)}}{\sqrt{2}}\,,\qquad b_{\vec{p}}^\dagger=\frac{a_{\vec{p},(1)}^\dagger+\imagu a_{\vec{p},(2)}^\dagger}{\sqrt{2}}\,,
\end{equation}
recovering the looking familiar expressions
\begin{subequations}    
    \begin{align}
        \phi(t,\vec{x})&=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}\Big\{a_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+b_{\vec{p}}^\dagger e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\Big\}\,,\\
        \pi(t,\vec{x})&=\int\frac{\dt^3p}{(2\pi)^3}\frac{\imagu\omega_{\vec{p}}}{\sqrt{2\omega_{\vec{p}}}}\Big\{-b_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+a_{\vec{p}}^\dagger e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\Big\}\,.
    \end{align}
\end{subequations}
Unlike before, we now explicitly find ${a_{\vec{p}}\neq b_{\vec{p}}}$, since there is no reality condition to be imposed on the fields $\phi$. The commutation relations of $a_{\vec{p},(k)}$, $a_{\vec{p},(k)}^\dagger$ are trivially given by
\begin{equation}
    [a_{\vec{p},(j)},a_{\vec{q},(k)}^\dagger]=(2\pi)^3\delta^{(3)}(\vec{p}-\vec{q})\delta_{jk}\,,\qquad[a_{\vec{p},(j)}^{(\dagger)},a_{\vec{p},(k)}^{(\dagger)}]=0
\end{equation}
and lead to (see Appendix \ref{sec:Apdx_ComplLadderCommut})
\begin{equation}
    \begin{aligned}
        [a_{\vec{p}},b_{\vec{q}}]&=0=[a_{\vec{p}}^\dagger,b_{\vec{q}}^\dagger]\,,&[a_{\vec{p}}^{(\dagger)},a_{\vec{q}}^{(\dagger)}]&=0=[b_{\vec{p}}^{(\dagger)},b_{\vec{q}}^{(\dagger)}]\,,\\
        [a_{\vec{p}},b_{\vec{q}}^\dagger]&=0=[a_{\vec{p}}^\dagger,b_{\vec{q}}]\,,&[a_{\vec{p}},a_{\vec{q}}^\dagger]&=(2\pi)^3\delta^{(3)}(\vec{p}-\vec{q})=[b_{\vec{p}},b_{\vec{q}}^\dagger]\,.
    \end{aligned}
    \label{eq:ComplLadderCommut}
\end{equation}
From this, again the Hamiltonian is derived to be
% \begin{subequations}
%     \begin{align}        
%         H&=\int\frac{\dt^3p}{(2\pi)^3}\omega_{\vec{p}}\Big(a_{\vec{p},(1)}^\dagger a_{\vec{p},(1)}+a_{\vec{p},(2)}^\dagger a_{\vec{p},(2)}+\frac{1}{2}\big([a_{\vec{p},(1)},a_{\vec{p},(1)}^\dagger]+[a_{\vec{p},(2)},a_{\vec{p},(2)}^\dagger]\big)\Big)\\
%         &=\int\frac{\dt^3p}{(2\pi)^3}\omega_{\vec{p}}\Big(a_{\vec{p}}^\dagger a_{\vec{p}}+b_{\vec{p}}^\dagger b_{\vec{p}}+\frac{1}{2}\big([a_{\vec{p}},a_{\vec{p}}^\dagger]+[b_{\vec{p}},b_{\vec{p}}^\dagger]\big)\Big)
%     \end{align}
% \end{subequations}
% using ${a_{\vec{p}}^\dagger a_{\vec{p}}=\frac{1}{2}(a_{\vec{p},(1)}^\dagger-\imagu a_{\vec{p},(2)}^\dagger)(a_{\vec{p},(1)}+\imagu a_{\vec{p},(2)})}$ and ${b_{\vec{p}}^\dagger b_{\vec{p}}=\frac{1}{2}(a_{\vec{p},(1)}^\dagger+\imagu a_{\vec{p},(2)}^\dagger)(a_{\vec{p},(1)}-\imagu a_{\vec{p},(2)})}$.
\begin{equation}      
        H=\int\frac{\dt^3p}{(2\pi)^3}\omega_{\vec{p}}\Big(a_{\vec{p}}^\dagger a_{\vec{p}}+b_{\vec{p}}^\dagger b_{\vec{p}}+\frac{1}{2}\big([a_{\vec{p}},a_{\vec{p}}^\dagger]+[b_{\vec{p}},b_{\vec{p}}^\dagger]\big)\Big)\,.
\end{equation}

Together with the commutation relations \eqref{eq:ComplLadderCommut} this offers an intuitive interpretation: The sets of operators ${\{a_{\vec{p}},a_{\vec{p}}^\dagger\}}$ and ${\{b_{\vec{p}},b_{\vec{p}}^\dagger\}}$ commute and each set fulfills the same algebraic relations as the real field $\varphi$ in the last section. They correspond to the creation and annihilation of particles and antiparticles respectively. Whereas ${n_{\vec{p}}=\langle a_{\vec{p}}^\dagger a_{\vec{p}}\rangle}$ has the interpretation of a particle number density, ${\overline{n}_{\vec{p}}=\langle b_{\vec{p}}^\dagger b_{\vec{p}}\rangle}$ is understood as the antiparticle density.




\section{Particle Spectra from Classical Sources}

We want to relate the experimentally observed spectra to the quantitites $n_{\vec{p}}$ defined by quantization of the field theory describing the interaction of the particles. Unfortunately, the notion of a particle in an interacting quantum field theory is not well-defined. The particle interpretation from the last section relies heavily on the validity of the free Klein-Gordon equation, its plane waves solutions and the relativistic dispersion relation of freely propagating particles. In a scattering event, the free theory is usually only a limiting case when particle densities are low or when the interacting fields have very small spatial overlap. The measurement of particles after a HIC can be understood as a zero-to-many particle scattering event. Long before the collision, there are no particles in the system. The interaction is turned on when the nuclei collide and the strong interaction between their constituents leads to complicated dynamics. After the fireball has expanded and cooled down, the density of the strongly interacting QGP has decreased and the mesonic bound states produced in the interaction propagate approximately as free particles to be measured on the detector surface.

To make progress in the description of the particle spectra in the non-interacting limit after an interaction took place, we shall model the interaction dynamics by a spacetime dependent source $J(x)$ and make use of the concept of Greens functions. They are used to study for example correlations or the response of a system to perturbations.

\subsection{Real Scalar Field}

Following referece \cite{GreinerEtAl_1996}, define the Pauli-Jordan function $\Delta(x)$ for example by one of the equivalent representations
% \begin{align}
%     \imagu\Delta(x-y)&=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}\Big(e^{-\imagu (\omega_{\vec{p}}(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))}-e^{\imagu (\omega_{\vec{p}}(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))}\Big)\\
%     &=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}\Big(e^{\imagu p(x-y)}-e^{-\imagu p(x-y)}\Big)\\
%     &=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}\Big(e^{-\imagu \omega_{\vec{p}}(x^0-y^0)}-e^{\imagu \omega_{\vec{p}}(x^0-y^0)}\Big)e^{\imagu\vec{p}(\vec{x}-\vec{y})}\\
%     &=2\pi\int\frac{\dt^4p}{(2\pi)^4}\text{sign}(p^0)\delta(p^2+m^2)e^{-\imagu(p^0(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))}\\
%     &=2\pi\int\frac{\dt^4p}{(2\pi)^4}\text{sign}(p^0)\delta(p^2+m^2)e^{\imagu p(x-y)}
% \end{align}
\begin{subequations}
    \begin{align}
        \imagu\Delta(x-y)&=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}\Big(e^{-\imagu (\omega_{\vec{p}}(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))}-e^{\imagu (\omega_{\vec{p}}(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))}\Big)\\
        &=2\pi\int\frac{\dt^4p}{(2\pi)^4}\text{sign}(p^0)\delta(p^2+m^2)e^{\imagu p(x-y)}\,.
    \end{align}
\end{subequations}
As a sum of plane waves with 4-momenta satisfying the relativistic dispersion relation, it satisfies ${(\partial_\mu\partial^\mu-m^2)\Delta=0}$. The retarded and advanced propagators $\Delta_{R,A}(x)$ are given by 
\begin{equation}
    \Delta_R(x)=\Theta(x^0)\Delta(x)\,,\qquad\Delta_A(x)=-\Theta(-x^0)\Delta(x)\,,
\end{equation}
which immediately implies $\Delta(x)=\Delta_R(x)-\Delta_A(x)$. These function satisfy
\begin{equation}
    (\partial_\mu\partial^\mu-m^2)\Delta_{R,A}(x)=\delta^{(4)}(x)\,,
\end{equation}
as can be checked from the explicit construction performed in Appendix \ref{sec:Apdx_GreensFunctionsKG}.

Whereas the free Klein-Gordon equation can be used to describe the propagation of field excitations, it does not describe the origin or creation of such excitations from the vacuum. To do so, one can add an external driving force or source term $J$ to find the inhomogeneous Klein-Gordon equation
\begin{equation}
    (\partial_\mu\partial^\mu-m^2)\varphi(x)=-J(x)\,.
\end{equation}
This source term replaces all self-interactions terms of higher order than $\varphi^2$ in the Lagrangian, and possibly further interactions of the field $\varphi$ with other fields. The precise form could in principle be obtained by the full Lagrangian capturing all the relevant interactions at play, but choosing an external source $J$ as a placeholder suffices for our needs. The only physically relevant properties of $J$ are reality in the case of real-valued $\varphi$, and finite support, meaning $J$ vanishes before the collision and long after the collision, when the fluid or gas of interacting particles has been thinned out.

The solution is constructed by superposition of homogeneous solutions and a particular inhomogeneous solutions, which is easily constructed with the help of the Greens functions discussed before. Requesting ${\varphi\equiv 0}$ for vanishing source, one finds
\begin{subequations}
    \begin{align}        
        \varphi_J(x)&=-\int\dt^4y\Delta_R(x-y)J(y)\\
        &=\imagu\int\dt^4y\Theta(x^0-y^0)\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}(e^{\imagu p(x-y)}-e^{-\imagu p(x-y)})J(y)\\
        \overset{x^0\gg y^0}&{=}\imagu \int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}(J(p)e^{\imagu px}-J(-p)e^{-\imagu px})\\
        &=\imagu\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}(J(p)e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}-J(-p)e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})})\,,
        \label{eq:ClassicalFieldAfterSource}
    \end{align}
\end{subequations}
where $J(p)=\int\dt^4y J(x)e^{-\imagu py}$ was used and implies evaluation on on-shell 4-momenta. The usage of the retarded propagator ensures the preservation of causality, since the source may only affect events within its own future light cone. Taking the homogeneous solution $\varphi_0$ as given by \eqref{eq:CanonicalQuant_RealScalar} into account, the field after the source has vanished is given by
\begin{multline}
    \varphi(t,x)=\varphi_0(t,\vec{x})+\varphi_J(t,\vec{x})\\
    =\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}\left\{\big(a_{\vec{p}}+\frac{\imagu J(p)}{\sqrt{2\omega_{\vec{p}}}}\big)e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}+\big(a_{\vec{p}}^\dagger-\frac{\imagu J(-p)}{\sqrt{2\omega_{\vec{p}}}}\big)e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\right\}\,.
\end{multline}
This is described by effectively replacing annihilation and creation operators via
\begin{equation}
    a_{\vec{p}}\mapsto a_{\vec{p}}+\frac{\imagu J(p)}{\sqrt{2\omega_{\vec{p}}}}\,,\qquad a_{\vec{p}}^\dagger\mapsto a_{\vec{p}}^\dagger-\frac{\imagu J(-p)}{\sqrt{2\omega_{\vec{p}}}}\,.
\end{equation}
These replacements are of course compatible, considering that for a real source ${J(p)=J^*(-p)}$. Since $J(p)$ is just a $\mathbb{C}$-number, it does not alter the commutation relations from which the Hamiltonian and number operator are derived. Starting without any particles in the system corresponds to considering the state $\ket{0}$ with respect to the initially defined creation and annihilation operators. The number density after the source has vanished is then given by
\begin{equation}
    n_{\vec{p},J}=\bra{0}\Big(a_{\vec{p}}+\frac{\imagu J(p)}{\sqrt{2\omega_{\vec{p}}}}\Big)\Big(a_{\vec{p}}^\dagger-\frac{\imagu J^*(p)}{\sqrt{2\omega_{\vec{p}}}}\Big)\ket{0}=\frac{1}{2\omega_{\vec{p}}}\abs{J(p)}^2\,.
    \label{eq:RealField_NumOpExval_Source}
\end{equation}
The Lorentz invariant formulation of this identity, compare equation \eqref{eq:SpectraConversion}, reads
\begin{equation}
    \frac{1}{2\pi p_T}\frac{\dt N}{\dt p_T\dt\eta_p}=\frac{1}{(2\pi)^3}\vert J(p)\vert^2\,.
\end{equation}

\subsection{Complex Scalar Field}

The derivation for the creation of particles and antiparticles as excitations of a complex-valued scalar field is completely analogous up to miniscule changes. The identity ${J(p)=J^*(-p)}$ may not be used anymore. Instead, $J(p)$ contributes to the spectrum of particles, whereas $J(-p)$ contributes to the spectrum of antiparticles, in the following way:
\begin{equation}
    a_{\vec{p}}\mapsto a_{\vec{p}}+\frac{\imagu J(p)}{\sqrt{2\omega_{\vec{p}}}}\,,\qquad b_{\vec{p}}^\dagger\mapsto b_{\vec{p}}^\dagger-\frac{\imagu J(-p)}{\sqrt{2\omega_{\vec{p}}}}
\end{equation}
The particle and antiparticle momentum space number densities induced by the source $J$ are now
\begin{equation}
    n_{\vec{p},J}=\frac{1}{2\omega_{\vec{p}}}\abs{J(p)}^2\,,\qquad \overline{n}_{\vec{p},J}=\frac{1}{2\omega_{\vec{p}}}\abs{J(-p)}^2\,.
    \label{eq:SpectraFromSource}
\end{equation}
This equation covers the case of real fields.


\subsection{Relation to Coherent State Formalism}

The above arguments are made based on the solutions of classical equations of motion. In the quantum theory, coherent states are states for which the expectation values of the quantized operators reproduce the equations of motion of observables in the classical theory. Without claiming completeness, let us briefly outline the connection between the classical equations of motion and the corresponding coherent state for the example of real scalar fields.

In the Heisenberg picture, operators are time dependent. Denoting the field operator $\varphi$ long before the interaction by $\varphi_{\text{in}}$ and long after the interaction as $\varphi_{\text{out}}$, they are related by some unitary transformation
\begin{equation}
    \varphi_{\text{out}}=S^\dagger \varphi_{\text{in}}S=\varphi_{\text{in}}+S^\dagger[\varphi_{\text{in}},S]\,,
\end{equation}
where we used ${S^\dagger S=\mathbb{1}}$. On the level of eigenstates of the time dependent operators, the transformation reads ${\ket{\cdot}_{\text{out}}=S^\dagger\ket{\cdot}_{\text{in}}}$. The operator $S$ is called the scattering matrix. In the last section we found that in the limit ${x^0\gg y^0}$,
\begin{equation}
    \varphi_{\text{out}}=\varphi_{\text{in}}-\int\dt^4y\Delta(x-y)J(y)\,.
\end{equation}
From the canonically quantized field \eqref{eq:CanonicalQuant_RealScalar}, a straightforward calculation utilizing the canonical commutation relations \eqref{eq:LadderOpsCommut} reveals
\begin{subequations}
    \begin{align}
        [\varphi(x),\varphi(y)]&=\int\frac{\dt^3p\dt^3q}{(2\pi)^3(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}\sqrt{2\omega_{\vec{q}}}}\Big([a_{\vec{p}}e^{-\imagu(\omega_{\vec{p}}x^0-\vec{p}\vec{x})},a_{\vec{q}}^\dagger e^{\imagu(\omega_{\vec{q}}y^0-\vec{q}\vec{y})}]\\
        &\phantom{=}+[a_{\vec{p}}^\dagger e^{\imagu(\omega_{\vec{p}}x^0-\vec{p}\vec{x})},a_{\vec{q}} e^{-\imagu(\omega_{\vec{q}}y^0-\vec{q}\vec{y})}]\Big)\\
        &=\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}(e^{-\imagu(\omega_{\vec{p}}(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))}-e^{\imagu(\omega_{\vec{p}}(x^0-y^0)-\vec{p}(\vec{x}-\vec{y}))})\\
        &=\imagu\Delta(x-y)\,,
    \end{align}
\end{subequations}
which is just a complex scalar. Using further the relations
\begin{equation}
    [A,B]=c\in\mathbb{C}\quad\implies\quad[A,B^n]=c\cdot nB^{n-1}\;\wedge\;[A,\exp(B)]=c\cdot\exp(B)
\end{equation}
for the operators ${A=\varphi_{\text{in}}(x)}$, ${B=\imagu\int\dt^4y\varphi_{\text{in}}(y)J(y)}$ and thus ${c=-\int\dt^4y\Delta(x-y)J(y)}$, one can see that the scattering matrix is given by
\begin{equation}
    S=\exp\Big(\imagu\int\dt^4y\varphi_{\text{in}}(y)J(y)\Big)\,.
\end{equation}
Working in Fourier modes,
\begin{align}
    \int\dt^4y\varphi_{\text{in}}(y)J(y)&=\int\dt^4y\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}\left\{a_{\vec{p}}e^{\imagu py}+a_{\vec{p}}^\dagger e^{-\imagu py}\right\}J(y)\\
    &=\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}(a_{\vec{p}}J(-p)+a_{\vec{p}}^\dagger J(p))\\
    &=\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}(a_{\vec{p}}J^*(p)+a_{\vec{p}}^\dagger J(p))
\end{align}
and using the well known BCH-formula
\begin{equation}
    e^{A+B}=e^{-[A,B]/2}e^Ae^B
\end{equation}
for operators ${A,B}$ where ${[A,B]=c\in\mathbb{C}}$ it is now easy to show that
\begin{multline}
    S=\exp\Big(\frac{1}{2}\int\frac{\dt^3p\dt^3q}{(2\pi)^3(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}\sqrt{2\omega_{\vec{q}}}}J(p)J^*(q)[a_{\vec{p}}^\dagger,a_{\vec{q}}]\Big)\times\\
    \times\exp\Big(\imagu\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}J(p)a_{\vec{p}}^\dagger\Big)\exp\Big(\imagu\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}J^*(p)a_{\vec{p}}\Big)
\end{multline}
\begin{multline}
    S=\exp\Big(-\frac{1}{2}\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}\vert J(p)\vert^2\Big)\times\\
    \times\exp\Big(\imagu\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}J(p)a_{\vec{p}}^\dagger\Big)\exp\Big(\imagu\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}J^*(p)a_{\vec{p}}\Big)
\end{multline}
The out-state ${\ket{0}_{\text{out}}=S^\dagger\ket{0}_{\text{in}}}$ of the vacuum in-state $\ket{0}_{\text{in}}$ is thus given by
\begin{equation}
    \ket{0}_{\text{out}}=\exp\Big(-\frac{1}{2}\int\frac{\dt^3p}{(2\pi)^3}\frac{1}{2\omega_{\vec{p}}}\vert J(p)\vert^2\Big)\exp\Big(-\imagu\int\frac{\dt ^3p}{(2\pi)^3}\frac{1}{\sqrt{2\omega_{\vec{p}}}}J(p)a_{\vec{p}}^\dagger\Big)\ket{0}_{\text{in}}\,,
\end{equation}
which is a coherent state. It is an eigenstate to the creation operator,
\begin{equation}
    a_{\vec{p}}\ket{0}_{\text{out}}=\frac{-\imagu J(p)}{\sqrt{2\omega_{\vec{p}}}}\ket{0}_{\text{out}}
\end{equation}
and by computing the expectation value of the number operator ${a^\dagger_{\vec{p}}a_{\vec{p}}}$ w.r.t. $\ket{0}_{\text{out}}$ we verify the formerly stated result \eqref{eq:RealField_NumOpExval_Source}.

\subsection{Extracting the Source from the Late Time Field}

Given an external source term $J(x)$ we are able to predict the particle content in the non-interacting limit. Since $J$ is really only a placeholder for lots of complicated interaction terms that depend on the fields in a non-linear way, we cannot immediately write down the source in position or momentum space. Instead we would like to rephrase the problem in a way that enables us to compute the shape of the hypothetical source from the knowledge of the field. Equation \eqref{eq:ClassicalFieldAfterSource} allows us to do just that, giving (for real or complex field values)
\begin{subequations}
    \begin{align}        
        % J(p)e^{-\imagu\omega_{\vec{p}}t}&=\int\dt^3x\Big(-\imagu\omega_{\vec{p}}\phi_J(x)+\big(\partial_t\phi_J(x)\big)\Big)e^{-\imagu\vec{p}\vec{x}}\\
        J(p)&=\int\dt^3x\Big(\phi_J(x)\overset{\leftarrow}{\partial_t}e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}-\phi_J(x)\overset{\rightarrow}{\partial_t}e^{\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\Big)\,,\\
        % J(-p)e^{\imagu\omega_{\vec{p}}t}&=-\int\dt^3x\Big(-\imagu\omega_{\vec{p}}\phi_J(x)-\big(\partial_t\phi_J(x)\big)\Big)e^{\imagu\vec{p}\vec{x}}\\
        J(-p)&=\int\dt^3x\Big(\phi_J(x)\overset{\leftarrow}{\partial_t}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}-\phi_J(x)\overset{\rightarrow}{\partial_t}e^{-\imagu(\omega_{\vec{p}}t-\vec{p}\vec{x})}\Big)\,.
    \end{align}
    \label{eq:SourceFieldRelation}
\end{subequations} 
Finding a suitable prescription or model for $\phi_J$ will ultimately be the challenge of this. This line of thought was already pursued in \cite{Amelino-CameliaEtAl_1997}.